#!/usr/bin/env python
# -*- coding: utf-8 -*-

from TestMaker.core import TestMaker
from optparse import OptionParser
import os

parser = OptionParser()
parser.add_option('-c', "--config", dest="cfg_file", help="configuration file")
parser.add_option('-n', "--new", dest="new_version", help="create all new materials")
(options, args) = parser.parse_args()

if options.cfg_file:
    tm = TestMaker(options.cfg_file)
    tm.load_questions()

    if options.new_version:
        tm.create_all_versions()
        os.system("cp output/key.txt versions")
        os.system("cp output/*.json versions")

    tm.render_all_versions()
    os.system("cp output/*.pdf archive")
    os.system("mv archive/*KEY.pdf archive/keys")
    os.system("mv archive/*.pdf archive/exams")
else:
    print "--config is a required option"
    sys.exit()

